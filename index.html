<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["shell","ruby","python","php","java","javascript","go"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="ruby">Ruby</a>
              <a href="#" data-language-name="python">Python</a>
              <a href="#" data-language-name="php">PHP</a>
              <a href="#" data-language-name="java">Java</a>
              <a href="#" data-language-name="javascript">Node</a>
              <a href="#" data-language-name="go">Go</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<blockquote>
<h3 id="api-endpoint">API Endpoint</h3>

<p>https://api.tofupay.com</p>
</blockquote>

<h3 id="api-reference">API Reference</h3>

<p>The Tofupay API is organized around <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">REST</a>. Our API is designed to have predictable, resource-oriented URLs and to use HTTP response codes to indicate API errors. We use built-in HTTP features, like HTTP authentication and HTTP verbs, which can be understood by off-the-shelf HTTP clients, and we support <a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing">cross-origin resource sharing</a> to allow you to interact securely with our API from a client-side web application (though you should remember that you should never expose your secret API key in any public website&rsquo;s client-side code). <a href="http://www.json.org/">JSON</a> will be returned in all responses from the API, including errors (though if you&rsquo;re using API bindings, we will convert the response to the appropriate language-specific object).
To make the Tofupay API as explorable as possible, accounts have test-mode API keys as well as live-mode API keys. These keys can be active at the same time. Data created with test-mode credentials will never hit the credit card networks and will never cost anyone money.</p>

<h1 id="authentication">Authentication</h1>

<blockquote>
<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/charges <span class="se">\</span>
   -u key_private_sandbox_qg15eqpUrbT6Gufhjq9ds0Jc:
</code></pre>

<blockquote>
<p>curl uses the -u flag to pass basic auth credentials (adding a colon after your API key will prevent it from asking you for a password).</p>
</blockquote>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"key_private_sandbox_qg15eqpUrbT6Gufhjq9ds0Jc"</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"key_private_sandbox_qg15eqpUrbT6Gufhjq9ds0Jc"</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");
</code></pre>

<blockquote>
<p>Make sure to replace <code class="prettyprint">api.key</code> with your API key.</p>
</blockquote>

<p>You authenticate to the Tofupay API by providing one of your API keys in the request. You can manage your API keys from your <a href="https://dashboard.tofupay.com/account">account</a>. You can have multiple API keys active at one time. Your API keys carry many privileges, so be sure to keep them secret!
To use your API key, you need only set tofupay.api_key equal to the key. The Python library will automatically send this key in each request.
All API requests must be made over <a href="http://en.wikipedia.org/wiki/HTTPS">HTTPS</a>. Calls made over plain HTTP will fail. You must authenticate for all requests.</p>

<p><code class="prettyprint">Authorization: api.key</code></p>

<aside class="notice">
You must replace `api.key` with your personal API key.
</aside>

          <h1 id="transactions">Transactions</h1>

<p>To transaction a credit or a debit card, you create a transaction object. You can retrieve and refund individual transactions as well as list all transactions. Transactions are identified by a unique random ID.</p>

<h2 id="the-transaction-object">The transaction object</h2>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transaction"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1428926553</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"succeeded"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15r6GqLdZh7jQOUqtMqEPMu2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance_transaction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15IehrLdZh7jQOUq2dX5hcyV"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"invoice"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dispute"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"statement_descriptor"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fraud_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"receipt_email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"receipt_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"shipping"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"application_fee"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transactions/txn_15r6GrLdZh7jQOUqvvc9t1fA/refunds"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>The ID of the desired transaction.</td>
</tr>
<tr>
<td>object</td>
<td>string</td>
<td>&lsquo;transaction&rsquo;</td>
</tr>
<tr>
<td>created</td>
<td>timestamp</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

<h2 id="create-a-transaction">Create a transaction</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>POST https://api.tofupay.com/v1/transactions</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/transactions <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc: <span class="se">\</span>
   -d <span class="nv">amount</span><span class="o">=</span>400 <span class="se">\</span>
   -d <span class="nv">currency</span><span class="o">=</span>usd <span class="se">\</span>
   -d <span class="nv">token</span><span class="o">=</span>tok_15XZLsLdZh7jQOUq86ISvtjn <span class="se">\</span>
   -d <span class="nv">description</span><span class="o">=</span><span class="s2">"Transaction for test@example.com"</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="no">Tofupay</span><span class="o">::</span><span class="no">Transaction</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="mi">400</span><span class="p">,</span>
  <span class="ss">:currency</span> <span class="o">=&gt;</span> <span class="s2">"usd"</span><span class="p">,</span>
  <span class="ss">:token</span> <span class="o">=&gt;</span> <span class="s2">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span><span class="p">,</span> <span class="c1"># obtained with Tofupay.js</span>
  <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">"Transaction for test@example.com"</span>
<span class="p">)</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">tofupay</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="n">amount</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
  <span class="n">currency</span><span class="o">=</span><span class="s">"usd"</span><span class="p">,</span>
  <span class="n">token</span><span class="o">=</span><span class="s">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span><span class="p">,</span> <span class="c"># obtained with Tofupay.js</span>
  <span class="n">description</span><span class="o">=</span><span class="s">"Transaction for test@example.com"</span>
<span class="p">)</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

\Tofupay\Transaction::create(array(
  "amount" =&gt; 400,
  "currency" =&gt; "usd",
  "token" =&gt; "tok_15XZLsLdZh7jQOUq86ISvtjn", // obtained with Tofupay.js
  "description" =&gt; "Transaction for test@example.com"
));
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transaction"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1428926553</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"succeeded"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15r6GqLdZh7jQOUqtMqEPMu2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance_transaction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15IehrLdZh7jQOUq2dX5hcyV"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"invoice"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dispute"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"statement_descriptor"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fraud_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"receipt_email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"receipt_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"shipping"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"application_fee"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transactions/txn_15r6GrLdZh7jQOUqvvc9t1fA/refunds"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>To transaction a credit card, you create a transaction object. If your API key is in test mode, the supplied card won&rsquo;t actually be transactiond, though everything else will occur as if in live mode. (tofupay assumes that the transaction would have completed successfully).</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td><strong>Y</strong></td>
<td>double</td>
<td>The amount to be transactiond.</td>
</tr>
<tr>
<td>currency</td>
<td><strong>Y</strong></td>
<td>string</td>
<td>3-letter <a href="https://support.tofupay.com/questions/which-currencies-does-tofupay-support">ISO code</a> for currency.</td>
</tr>
<tr>
<td>token</td>
<td>optional, either <strong>token</strong> or <strong>customer</strong> is required</td>
<td>string</td>
<td>A payment card token.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>customer</td>
<td>optional, either <strong>token</strong> or <strong>customer</strong> is required</td>
<td>string</td>
<td>An ID of a customer to be transactiond.</td>
</tr>
<tr>
<td>country</td>
<td>N</td>
<td>string</td>
<td>Two-letter ISO code representing the country of the card.</td>
</tr>
<tr>
<td>description</td>
<td>N</td>
<td>string</td>
<td>Additional optional description of the transaction.</td>
</tr>
<tr>
<td>capture</td>
<td>N, default <strong>true</strong></td>
<td>boolean</td>
<td>Whether or not to immediately capture the transaction. When false, the transaction issues an authorization (or pre-authorization), and will need to be captured later. Uncaptured transactions expire in 7 days. For more information, see authorizing</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns a transaction object if the transaction succeeded. Returns an <a href="https://tofupay.com/docs/api#errors">error</a> if something goes wrong. A common source of error is an invalid or expired card, or a valid card with insufficient available balance.</p>

<h2 id="retrieve-a-transaction">Retrieve a transaction</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>GET https://api.tofupay.com/v1/transactions/{TRANSACTION_ID}</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/transactions/tok_15XZLsLdZh7jQOUq86ISvtjn <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc:
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"Tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="no">Tofupay</span><span class="o">::</span><span class="no">Transaction</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s2">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">Tofupay</span>
<span class="n">Tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">Tofupay</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

\Tofupay\Transaction::retrieve("tok_15XZLsLdZh7jQOUq86ISvtjn");
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transaction"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1428926553</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"succeeded"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15r6GqLdZh7jQOUqtMqEPMu2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance_transaction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15IehrLdZh7jQOUq2dX5hcyV"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"invoice"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dispute"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"statement_descriptor"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fraud_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"receipt_email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"receipt_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"shipping"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"application_fee"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transactions/txn_15r6GrLdZh7jQOUqvvc9t1fA/refunds"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Retrieves the transactions object if a valid identifier was provided, and returns an <a href="https://tofupay.com/docs/api#errors">error</a> otherwise.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Y</td>
<td>string</td>
<td>The ID of the desired transaction.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns a transaction if a valid ID was provided. Raises an error otherwise.</p>

<h2 id="retrieve-all-transactions">Retrieve all transactions</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>GET https://api.tofupay.com/v1/transactions</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/transactions?limit<span class="o">=</span>3 <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc:
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"Tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="no">Tofupay</span><span class="o">::</span><span class="no">Transaction</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">:limit</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">Tofupay</span>
<span class="n">Tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">Tofupay</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

\Tofupay\Transaction::all(array("limit" =&gt; 3));
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transactions"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transaction"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1428926553</span><span class="p">,</span><span class="w">
      </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"succeeded"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15r6GqLdZh7jQOUqtMqEPMu2"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"balance_transaction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15IehrLdZh7jQOUq2dX5hcyV"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"invoice"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dispute"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"statement_descriptor"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"fraud_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"receipt_email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"receipt_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"shipping"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"application_fee"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transactions/txn_15r6GrLdZh7jQOUqvvc9t1fA/refunds"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...}</span><span class="p">,</span><span class="w">
    </span><span class="p">{</span><span class="err">...}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Returns a list of transactions you&rsquo;ve previously created. The transactions are returned in sorted order, with the most recent transactions appearing first.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>N</td>
<td>integer</td>
<td>Maximum number of transaction objects to be returned</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>A dictionary with a data property that contains an array of up to limit transactions. Each entry in the array is a separate transaction object. If no more transactions are available, the resulting array will be empty. If you provide a non-existent customer ID, this call returns an <a href="https://tofupay.com/docs/api#errors">error</a>.</p>

<h2 id="update-a-transaction">Update a transaction</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>POST https://api.tofupay.com/v1/transaction/{TRANSACTION_ID}</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/transactions/txn_15r6GrLdZh7jQOUqvvc9t1fA <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc: <span class="se">\</span>
   -d <span class="nv">description</span><span class="o">=</span><span class="s2">"Transaction for test@example.com"</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">ch</span> <span class="o">=</span> <span class="no">Tofupay</span><span class="o">::</span><span class="no">Charge</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">)</span>
<span class="n">ch</span><span class="p">.</span><span class="nf">description</span> <span class="o">=</span> <span class="s2">"Charge for test@example.com"</span>
<span class="n">ch</span><span class="p">.</span><span class="nf">save</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">ch</span> <span class="o">=</span> <span class="n">tofupay</span><span class="o">.</span><span class="n">Charge</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">)</span>
<span class="n">ch</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s">"Charge for test@example.com"</span>
<span class="n">ch</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

$ch = \Tofupay\Charge::retrieve("txn_15r6GrLdZh7jQOUqvvc9t1fA");
$ch-&gt;description = "Charge for test@example.com";
$ch-&gt;save();
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transaction"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1428926553</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"succeeded"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15r6GqLdZh7jQOUqtMqEPMu2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance_transaction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15IehrLdZh7jQOUq2dX5hcyV"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"invoice"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dispute"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"statement_descriptor"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fraud_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"receipt_email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"receipt_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"shipping"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"application_fee"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transactions/txn_15r6GrLdZh7jQOUqvvc9t1fA/refunds"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Updates the specified transaction by setting the values of the parameters passed. Any parameters not provided will be left unchanged.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>description</td>
<td>N</td>
<td>string</td>
<td>The description of the transaction.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns the transaction object if the update succeeded. This call will return an <a href="https://tofupay.com/docs/api#errors">error</a> if update parameters are invalid.</p>

<h2 id="capture-a-transaction">Capture a transaction</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>POST https://api.tofupay.com/v1/transactions/{TRANSACTION_ID}/capture</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/transactions/tok_15XZLsLdZh7jQOUq86ISvtjn/capture <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc: <span class="se">\</span>
   -X POST
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">ch</span> <span class="o">=</span> <span class="no">Tofupay</span><span class="o">::</span><span class="n">transaction</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">)</span>
<span class="n">ch</span><span class="p">.</span><span class="nf">capture</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">ch</span> <span class="o">=</span> <span class="n">tofupay</span><span class="o">.</span><span class="n">transaction</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">)</span>
<span class="n">ch</span><span class="o">.</span><span class="n">capture</span><span class="p">()</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

$ch = \Tofupay\transaction::retrieve("txn_15r6GrLdZh7jQOUqvvc9t1fA");
$ch-&gt;capture();
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transaction"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1428926553</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"succeeded"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15r6GqLdZh7jQOUqtMqEPMu2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance_transaction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15IehrLdZh7jQOUq2dX5hcyV"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"invoice"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dispute"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"statement_descriptor"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fraud_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"receipt_email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"receipt_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"shipping"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"application_fee"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transactions/txn_15r6GrLdZh7jQOUqvvc9t1fA/refunds"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Capture the payment of an existing, uncaptured, transaction. This is the second half of the two-step payment flow, where first you <a href="https://tofupay.com/docs/api/curl#create_transaction">created a transaction</a> with the capture option set to false.
Uncaptured payments expire exactly seven days after they are created. If they are not captured by that point in time, they will be marked as refunded and will no longer be capturable.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Y</td>
<td>string</td>
<td>The ID of the desired transaction.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns the transaction object, with an updated captured property (set to true). Capturing a transaction will always succeed, unless the transaction is already refunded, expired, captured, or an invalid capture amount is specified, in which case this method will return an <a href="https://tofupay.com/docs/api#errors">error</a>.</p>

<h2 id="refund-a-transaction">Refund a transaction</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>POST https://api.tofupay.com/v1/transactions/{TRANSACTION_ID}/refund</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/transactions/tok_15XZLsLdZh7jQOUq86ISvtjn/refund <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc: <span class="se">\</span>
   -X POST
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">ch</span> <span class="o">=</span> <span class="no">Tofupay</span><span class="o">::</span><span class="n">transaction</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">)</span>
<span class="n">ch</span><span class="p">.</span><span class="nf">refund</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">ch</span> <span class="o">=</span> <span class="n">tofupay</span><span class="o">.</span><span class="n">transaction</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">)</span>
<span class="n">ch</span><span class="o">.</span><span class="n">refund</span><span class="p">()</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

$ch = \Tofupay\transaction::retrieve("txn_15r6GrLdZh7jQOUqvvc9t1fA");
$ch-&gt;refund();
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15r6GrLdZh7jQOUqvvc9t1fA"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transaction"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1428926553</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"succeeded"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15r6GqLdZh7jQOUqtMqEPMu2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance_transaction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"txn_15IehrLdZh7jQOUq2dX5hcyV"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"invoice"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dispute"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"statement_descriptor"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fraud_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"receipt_email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"receipt_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"shipping"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"application_fee"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transactions/txn_15r6GrLdZh7jQOUqvvc9t1fA/refunds"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Creating a new refund will refund a transaction that has previously been created but not yet refunded. Funds will be refunded to the credit or debit card that was originally charged. The fees you were originally charged are also refunded.</p>

<p>Once entirely refunded, a charge can&rsquo;t be refunded again. This method will return an error when called on an already-refunded transaction, or when trying to refund more money than is left on a transaction.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>N</td>
<td>double</td>
<td>The amount represneting how much of this transaction to refund.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns the transaction object, with an updated refund property (set to true). Refunding a transaction will always succeed, unless the transaction is already refunded, expired, or an invalid refund amount is specified, in which case this method will return an <a href="https://tofupay.com/docs/api#errors">error</a>.</p>

          <h1 id="customers">Customers</h1>

<p>Customer objects allow you to perform recurring charges and track multiple charges that are associated with the same customer. The API allows you to create, delete, and update your customers. You can retrieve individual customers as well as a list of all your customers.</p>

<h2 id="the-customer-object">The customer object</h2>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1421056271</span><span class="p">,</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif@hong.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"delinquent"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/subscriptions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"account_balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/sources"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"default_source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>The ID of the customer.</td>
</tr>
<tr>
<td>object</td>
<td>string</td>
<td>&lsquo;customer&rsquo;</td>
</tr>
<tr>
<td>created</td>
<td>timestamp</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

<h2 id="create-a-customer">Create a customer</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>POST https://api.tofupay.com/v1/customers</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/customers <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc: <span class="se">\</span>
   -d <span class="nv">description</span><span class="o">=</span><span class="s2">"Customer for test@example.com"</span> <span class="se">\</span>
   -d <span class="nb">source</span><span class="o">=</span>tok_15XZLsLdZh7jQOUq86ISvtjn
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="no">Tofupay</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">:description</span> <span class="o">=&gt;</span> <span class="s2">"Customer for test@example.com"</span><span class="p">,</span>
  <span class="ss">:source</span> <span class="o">=&gt;</span> <span class="s2">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span> <span class="c1"># obtained with Tofupay.js</span>
<span class="p">)</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">tofupay</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="n">description</span><span class="o">=</span><span class="s">"Customer for test@example.com"</span><span class="p">,</span>
  <span class="n">source</span><span class="o">=</span><span class="s">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span> <span class="c"># obtained with Tofupay.js</span>
<span class="p">)</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

\Tofupay\Customer::create(array(
  "description" =&gt; "Customer for test@example.com",
  "source" =&gt; "tok_15XZLsLdZh7jQOUq86ISvtjn" // obtained with Tofupay.js
));
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1421056271</span><span class="p">,</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif@hong.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"delinquent"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/subscriptions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"account_balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/sources"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"default_source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Creates a new customer object.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>N</td>
<td>string</td>
<td>Email address.</td>
</tr>
<tr>
<td>description</td>
<td>N</td>
<td>string</td>
<td>Description.</td>
</tr>
<tr>
<td>card</td>
<td>N</td>
<td>string</td>
<td>A payment card token or dictionary containing a user&rsquo;s credit card details.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns a customer object if the call succeeded. </p>

<h2 id="retrieve-a-customer">Retrieve a customer</h2>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/customers/cus_5V50idQJ7fxkRX <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc:
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="no">Tofupay</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">tofupay</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"cus_5V50idQJ7fxkRX"</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

\Tofupay\Customer::retrieve("cus_5V50idQJ7fxkRX");
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1421056271</span><span class="p">,</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif@hong.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"delinquent"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/subscriptions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"account_balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/sources"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"default_source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Retrieves the details of an existing customer. You need only supply the unique customer identifier that was returned upon customer creation.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Y</td>
<td>string</td>
<td>The ID of the desired customer.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns a customer object if a valid identifier was provided. </p>

<h2 id="retrieve-all-customers">Retrieve all customers</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>GET https://api.tofupay.com/v1/customers</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/customers?limit<span class="o">=</span>3 <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc:
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="no">Tofupay</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">:limit</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">tofupay</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

\Tofupay\Customer::all(array("limit" =&gt; 3));
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1421056271</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif@hong.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"delinquent"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/subscriptions"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"account_balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/sources"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
            </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"default_source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...}</span><span class="p">,</span><span class="w">
    </span><span class="p">{</span><span class="err">...}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Returns a list of transactions you&rsquo;ve previously created. The transactions are returned in sorted order, with the most recent transactions appearing first.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>N</td>
<td>integer</td>
<td>Maximum number of transaction objects to be returned</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>A dictionary with a data property that contains an array of up to limit transactions. Each entry in the array is a separate transaction object. If no more transactions are available, the resulting array will be empty. If you provide a non-existent customer ID, this call returns an <a href="https://tofupay.com/docs/api#errors">error</a>.</p>

<h2 id="update-a-customer">Update a customer</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>POST https://api.tofupay.com/v1/customers/{CUSTOMER_ID}</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/customers/cus_5V50idQJ7fxkRX <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc: <span class="se">\</span>
   -d <span class="nv">description</span><span class="o">=</span><span class="s2">"Customer for test@example.com"</span>
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">cu</span> <span class="o">=</span> <span class="no">Tofupay</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="p">)</span>
<span class="n">cu</span><span class="p">.</span><span class="nf">description</span> <span class="o">=</span> <span class="s2">"Customer for test@example.com"</span>
<span class="n">cu</span><span class="p">.</span><span class="nf">source</span> <span class="o">=</span> <span class="s2">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span> <span class="c1"># obtained with Tofupay.js</span>
<span class="n">cu</span><span class="p">.</span><span class="nf">save</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">cu</span> <span class="o">=</span> <span class="n">tofupay</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"cus_5V50idQJ7fxkRX"</span><span class="p">)</span>
<span class="n">cu</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s">"Customer for test@example.com"</span>
<span class="n">cu</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

$cu = \Tofupay\Customer::retrieve("cus_5V50idQJ7fxkRX");
$cu-&gt;description = "Customer for test@example.com";
$cu-&gt;source = "tok_15XZLsLdZh7jQOUq86ISvtjn"; // obtained with Tofupay.js
$cu-&gt;save();
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1421056271</span><span class="p">,</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Customer for test@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kif@hong.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"delinquent"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/subscriptions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"account_balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_5V50idQJ7fxkRX/sources"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"funding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
        </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pass"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_line1_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamic_last4"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"default_source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_15g9tMLdZh7jQOUqZKKlKMIr"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Updates the specified customer by setting the values of the parameters passed. Any parameters not provided will be left unchanged.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Y</td>
<td>String</td>
<td>ID of a customer</td>
</tr>
<tr>
<td>email</td>
<td>N</td>
<td>string</td>
<td>Email address.</td>
</tr>
<tr>
<td>description</td>
<td>N</td>
<td>string</td>
<td>Description.</td>
</tr>
<tr>
<td>card</td>
<td>N</td>
<td>string</td>
<td>A payment card token or dictionary containing a user&rsquo;s credit card details.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns the customer object if the update succeeded. Returns an <a href="https://tofupay.com/docs/api#errors">error</a> if update parameters are invalid (e.g. specifying an invalid coupon or an invalid card).</p>

<h2 id="delete-a-customer">Delete a customer</h2>

<blockquote>
<h3 id="definition">DEFINITION</h3>

<p>DELETE https://api.tofupay.com/v1/customers/{CUSTOMER_ID}</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/customers/cus_5V50idQJ7fxkRX <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc: <span class="se">\</span>
   -X DELETE
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">cu</span> <span class="o">=</span> <span class="no">Tofupay</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="p">)</span>
<span class="n">cu</span><span class="p">.</span><span class="nf">delete</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">tofupay</span>
<span class="n">tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">cu</span> <span class="o">=</span> <span class="n">tofupay</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"cus_5V50idQJ7fxkRX"</span><span class="p">)</span>
<span class="n">cu</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

$cu = \Tofupay\Customer::retrieve("cus_5V50idQJ7fxkRX");
$cu-&gt;delete();
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_5V50idQJ7fxkRX"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permanently deletes a customer. It cannot be undone.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Y</td>
<td>string</td>
<td>The ID of the customer to be deleted.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns an object with a deleted parameter on success. If the customer ID does not exist, this call returns an <a href="https://tofupay.com/docs/api#errors">error</a>.</p>

          
          <h1 id="tokens">Tokens</h1>

<p>Often you want to be able to charge credit cards or send payments to bank accounts without having to hold sensitive card information on your own servers. Tofupay.js makes this easy in the browser, but you can use the same technique in other environments with our token API.
Tokens can be created with your publishable API key, which can safely be embedded in downloadable applications like iPhone and Android apps. You can then use a token anywhere in our API that a card or bank account is accepted. Note that tokens are not meant to be stored or used more than once—to store these details for use later, you should create Customer or Recipient objects.</p>

<h2 id="the-token-object">The token object</h2>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tok_pyPkf6WFrHY7A97ZEBWdqUKs"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1430200302</span><span class="p">,</span><span class="w">
  </span><span class="s2">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_uT8mw0wgSwDtSx3WzpyqGqOI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_four"</span><span class="p">:</span><span class="w"> </span><span class="mi">4242</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expire_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expire_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tofu Pay"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_postcode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>The ID of the desired token.</td>
</tr>
<tr>
<td>object</td>
<td>string</td>
<td>&lsquo;token&rsquo;</td>
</tr>
<tr>
<td>created</td>
<td>timestamp</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>

<h2 id="create-a-card-token">Create a card token</h2>

<blockquote>
<h3 id="definition">Definition</h3>

<p>POST https://api.tofupay.com/v1/tokens</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight shell">curl https://api.Tofupay.com/v1/tokens <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc: <span class="se">\</span>
   -d card[number]<span class="o">=</span>4242424242424242 <span class="se">\</span>
   -d card[exp_month]<span class="o">=</span>12 <span class="se">\</span>
   -d card[exp_year]<span class="o">=</span>2016 <span class="se">\</span>
   -d card[cvc]<span class="o">=</span>123
</code></pre>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"Tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="no">Tofupay</span><span class="o">::</span><span class="no">Token</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">:card</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="ss">:number</span> <span class="o">=&gt;</span> <span class="s2">"4242424242424242"</span><span class="p">,</span>
    <span class="ss">:exp_month</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">,</span>
    <span class="ss">:exp_year</span> <span class="o">=&gt;</span> <span class="mi">2016</span><span class="p">,</span>
    <span class="ss">:cvc</span> <span class="o">=&gt;</span> <span class="s2">"314"</span>
  <span class="p">},</span>
<span class="p">)</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">Tofupay</span>
<span class="n">Tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">tofupay</span><span class="o">.</span><span class="n">Token</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
  <span class="n">card</span><span class="o">=</span><span class="p">{</span>
    <span class="s">"number"</span><span class="p">:</span> <span class="s">'4242424242424242'</span><span class="p">,</span>
    <span class="s">"exp_month"</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="s">"exp_year"</span><span class="p">:</span> <span class="mi">2016</span><span class="p">,</span>
    <span class="s">"cvc"</span><span class="p">:</span> <span class="s">'123'</span>
  <span class="p">},</span>
<span class="p">)</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

\Tofupay\Token::create(array(
  "card" =&gt; array(
    "number" =&gt; "4242424242424242",
    "exp_month" =&gt; 4,
    "exp_year" =&gt; 2016,
    "cvc" =&gt; "314"
  )
));
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tok_pyPkf6WFrHY7A97ZEBWdqUKs"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1430200302</span><span class="p">,</span><span class="w">
  </span><span class="s2">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_uT8mw0wgSwDtSx3WzpyqGqOI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_four"</span><span class="p">:</span><span class="w"> </span><span class="mi">4242</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expire_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expire_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tofu Pay"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_postcode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Creates a single use token that wraps the details of a credit card. This token can be used in place of a credit card associative array with any API method. These tokens can only be used once: by creating a new charge object, or attaching them to a customer.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>number</td>
<td><strong>Y</strong></td>
<td>string</td>
<td>The card number without any spaces.</td>
</tr>
<tr>
<td>expire_month</td>
<td><strong>Y</strong></td>
<td>integer</td>
<td>Card expiry month. Format MM</td>
</tr>
<tr>
<td>expire_year</td>
<td><strong>Y</strong></td>
<td>string</td>
<td>Card expiry year. Format YY</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ccv</td>
<td>N</td>
<td>string</td>
<td>Card security code.</td>
</tr>
<tr>
<td>country</td>
<td>N</td>
<td>string</td>
<td>Two-letter ISO code representing the country of the card.</td>
</tr>
<tr>
<td>holder_name</td>
<td>N</td>
<td>string</td>
<td>Card holder full name.</td>
</tr>
<tr>
<td>address_1</td>
<td>N</td>
<td>string</td>
<td>Registered card address information.</td>
</tr>
<tr>
<td>address_2</td>
<td>N</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>address_city</td>
<td>N</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>address_country</td>
<td>N</td>
<td>string</td>
<td>Two-letter ISO code representing the country of the card.</td>
</tr>
<tr>
<td>address_postcode</td>
<td>N</td>
<td>string</td>
<td></td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>The created card token object is returned if successful. Otherwise, this call returns an error.</p>

<h2 id="retrieve-a-token">Retrieve a token</h2>

<blockquote>
<h3 id="definition">Definition</h3>

<p>GET https://api.tofupay.com/v1/tokens/{TOKEN_ID}</p>

<h3 id="example-request">Example Request</h3>
</blockquote>
<pre><code class="highlight ruby"><span class="nb">require</span> <span class="s2">"Tofupay"</span>
<span class="no">Tofupay</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="no">Tofupay</span><span class="o">::</span><span class="no">Token</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s2">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight python"><span class="kn">import</span> <span class="nn">Tofupay</span>
<span class="n">Tofupay</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_qg15eqpUrbT6Gufhjq9ds0Jc"</span>

<span class="n">Tofupay</span><span class="o">.</span><span class="n">Token</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">"tok_15XZLsLdZh7jQOUq86ISvtjn"</span><span class="p">)</span>
</code></pre>
<pre><code class="highlight php">\Tofupay\Tofupay::setApiKey("sk_test_qg15eqpUrbT6Gufhjq9ds0Jc");

\Tofupay\Token::retrieve("tok_15XZLsLdZh7jQOUq86ISvtjn");
</code></pre>
<pre><code class="highlight shell">curl https://api.tofupay.com/v1/tokens/tok_15XZLsLdZh7jQOUq86ISvtjn <span class="se">\</span>
   -u sk_test_qg15eqpUrbT6Gufhjq9ds0Jc:
</code></pre>

<blockquote>
<h3 id="example-response">Example Response</h3>
</blockquote>
<pre><code class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tok_pyPkf6WFrHY7A97ZEBWdqUKs"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1430200302</span><span class="p">,</span><span class="w">
  </span><span class="s2">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_uT8mw0wgSwDtSx3WzpyqGqOI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_four"</span><span class="p">:</span><span class="w"> </span><span class="mi">4242</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expire_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expire_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
    </span><span class="s2">"holder_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tofu Pay"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address_postcode"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Retrieves the token with the given ID.</p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Y</td>
<td>string</td>
<td>The ID of the desired token.</td>
</tr>
</tbody></table>

<h3 id="returns">Returns</h3>

<p>Returns a token if a valid ID was provided. Raises an error otherwise.</p>

          <h1 id="errors">Errors</h1>

<p>Tofupay uses conventional HTTP response codes to indicate success or failure of an API request. In general, codes in the 2xx range indicate success, codes in the 4xx range indicate an error that resulted from the provided information (e.g. a required parameter was missing, a charge failed, etc.), and codes in the 5xx range indicate an error with Tofupay&rsquo;s servers.
Not all errors map cleanly onto HTTP response codes, however. When a request is valid but does not complete successfully (e.g. a card is declined), we return a 402 error code.</p>

<p>The Tofupay API uses the following error codes:</p>

<h2 id="http-status-codes">HTTP status codes</h2>

<table><thead>
<tr>
<th>Status Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Often missing a required parameter.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified request could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

<h2 id="error-types">Error types</h2>

<table><thead>
<tr>
<th>Error Type</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>invalid_request_error</td>
<td>Invalid request errors arise when your request has invalid parameters.</td>
</tr>
<tr>
<td>api_error</td>
<td>API errors cover any other type of problem (e.g. a temporary problem with Tofupay&rsquo;s servers) and should turn up only very infrequently.</td>
</tr>
<tr>
<td>card_error</td>
<td>Card errors are the most common type of error you should expect to handle. They result when the user enters a card that can&rsquo;t be charged for some reason.</td>
</tr>
</tbody></table>

<h2 id="error-codes">Error codes</h2>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>incorrect_number</td>
<td>The card number is incorrect.</td>
</tr>
<tr>
<td>invalid_number</td>
<td>The card number is not a valid credit card number.</td>
</tr>
<tr>
<td>invalid_expiry_month</td>
<td>The card&rsquo;s expiration month is invalid.</td>
</tr>
<tr>
<td>invalid_expiry_year</td>
<td>The card&rsquo;s expiration year is invalid.</td>
</tr>
<tr>
<td>invalid_cvc</td>
<td>The card&rsquo;s security code is invalid.</td>
</tr>
<tr>
<td>expired_card</td>
<td>The card has expired.</td>
</tr>
<tr>
<td>incorrect_cvc</td>
<td>The card&rsquo;s security code is incorrect.</td>
</tr>
<tr>
<td>incorrect_zip</td>
<td>The card&rsquo;s zip code failed validation.</td>
</tr>
<tr>
<td>card_declined</td>
<td>The card was declined.</td>
</tr>
<tr>
<td>missing</td>
<td>There is no card on a customer that is being charged.</td>
</tr>
<tr>
<td>processing_error</td>
<td>An error occurred while processing the card.</td>
</tr>
<tr>
<td>rate_limit</td>
<td>An error occurred due to requests hitting the API too quickly. Please let us know if you&rsquo;re consistently running into this error.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="ruby">Ruby</a>
                <a href="#" data-language-name="python">Python</a>
                <a href="#" data-language-name="php">PHP</a>
                <a href="#" data-language-name="java">Java</a>
                <a href="#" data-language-name="javascript">Node</a>
                <a href="#" data-language-name="go">Go</a>
          </div>
      </div>
    </div>
  </body>
</html>
